<div class="container">
  <div style="text-align: center; margin: 5%">
    <h2>{{ edicion ? 'Editar Simulación de Precios' : 'Registrar Simulación de Precios' }}</h2>
  </div>

  <div>
    <form [formGroup]="form" (ngSubmit)="aceptar()">

      <!-- Código (solo lectura en edición) -->
      @if(edicion){
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>ID</mat-label>
        <input matInput formControlName="codigo" readonly />
      </mat-form-field>
      }

      <br />

      <!-- Usuario -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Usuario</mat-label>
        <input matInput formControlName="usuario" />
        <mat-error>
          @if (form.get('usuario')?.hasError('required')) {
            Seleccione un usuario!!
          }
        </mat-error>
      </mat-form-field>

      <br />

      <!-- Propiedad -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Propiedad</mat-label>
        <input matInput formControlName="propiedad" />
        <mat-error>
          @if (form.get('propiedad')?.hasError('required')) {
            Seleccione una propiedad!!
          }
        </mat-error>
      </mat-form-field>

      <br />

      <!-- Monto Inicial -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Monto Inicial</mat-label>
        <input matInput type="number" formControlName="monto_inicial" />
        <mat-error>
          @if (form.get('monto_inicial')?.hasError('required')) {
            Ingrese el monto inicial!!
          }
          @if (form.get('monto_inicial')?.hasError('min')) {
            El monto inicial debe ser mayor a 0!!
          }
        </mat-error>
      </mat-form-field>

      <br />

      <!-- Tasa de Interés -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Tasa de Interés (%)</mat-label>
        <input matInput type="number" formControlName="tasa_intereses" />
        <mat-error>
          @if (form.get('tasa_intereses')?.hasError('required')) {
            Ingrese la tasa de interés!!
          }
          @if (form.get('tasa_intereses')?.hasError('min') || form.get('tasa_intereses')?.hasError('max')) {
            La tasa debe estar entre 0.1% y 100%!!
          }
        </mat-error>
      </mat-form-field>

      <br />

      <!-- Plazo en Meses -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Plazo (meses)</mat-label>
        <input matInput type="number" formControlName="plazo_meses" />
        <mat-error>
          @if (form.get('plazo_meses')?.hasError('required')) {
            Ingrese el plazo!!
          }
          @if (form.get('plazo_meses')?.hasError('min') || form.get('plazo_meses')?.hasError('max')) {
            El plazo debe estar entre 1 y 360 meses!!
          }
        </mat-error>
      </mat-form-field>

      <br />

      <!-- Cuota Mensual -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Cuota Mensual</mat-label>
        <input matInput type="number" formControlName="cuota_mensual" />
        <mat-error>
          @if (form.get('cuota_mensual')?.hasError('required')) {
            Ingrese la cuota mensual!!
          }
          @if (form.get('cuota_mensual')?.hasError('min')) {
            La cuota debe ser mayor a 0!!
          }
        </mat-error>
      </mat-form-field>

      <br />

      <!-- Fecha -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Fecha</mat-label>
        <input matInput [matDatepicker]="pickerFecha" formControlName="fecha" />
        <mat-datepicker-toggle matIconSuffix [for]="pickerFecha"></mat-datepicker-toggle>
        <mat-datepicker #pickerFecha></mat-datepicker>
        <mat-error>
          @if (form.get('fecha')?.hasError('required')) {
            Seleccione la fecha!!
          }
        </mat-error>
      </mat-form-field>

      <br />

      <!-- Botones -->
      <div class="button-group">
        <button mat-flat-button color="primary" type="submit" [disabled]="!form.valid">
          {{ edicion ? 'Actualizar' : 'Registrar' }}
        </button>
        <button mat-stroked-button color="warn" type="button" (click)="cancelar()">
          Cancelar
        </button>
      </div>

    </form>
  </div>
</div>
